"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
var _moment = _interopRequireDefault(require("moment"));
var _removeAccents = require("./removeAccents");
var _utils = require("../../_utils");
var _localeConfig = require("../../localeConfig");
function _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }
const useFilter = () => {
  const removeMask = value => Number(value.replace(/[^0-9.-]+/g, ""));
  const userLocale = (0, _localeConfig.getUserLocale)()?.locale;
  const filterBy = (array, position, predicate) => {
    return array?.filter(element => {
      const childNodes = element?.props?.children;
      if (!childNodes) return false;
      const valueToFilter = (0, _utils.findInnerText)(childNodes[position]);
      return valueToFilter && predicate(valueToFilter);
    }) || [];
  };
  const filterByText = (value, array) => {
    const predicate = valueToFilter => (0, _removeAccents.removeAccents)(valueToFilter).toLowerCase().includes((0, _removeAccents.removeAccents)(value?.value).toLowerCase());
    return filterBy(array, value?.position, predicate);
  };
  const filterByOption = (value, array) => {
    const predicate = valueToFilter => value?.value?.includes(valueToFilter);
    return filterBy(array, value?.position, predicate);
  };
  const filterByDate = (value, array) => {
    const predicate = valueToFilter => {
      const [day, month, year] = valueToFilter.split('/');
      const pattern = userLocale === 'en-US' ? 'MM/DD/YYYY' : 'DD/MM/YYYY';
      const formattedDate = userLocale === 'en-US' ? (0, _moment.default)(`${year}-${day}-${month}`) : (0, _moment.default)(`${year}-${month}-${day}`);
      const startDate = (0, _moment.default)(value?.value?.start, pattern);
      const endDate = (0, _moment.default)(value?.value?.end, pattern);
      return formattedDate.isBetween(startDate, endDate, 'days');
    };
    return filterBy(array, value?.position, predicate);
  };
  const filterByBetween = (value, array) => {
    const predicate = valueToFilter => {
      const number = removeMask(valueToFilter.replaceAll('.', '').replace(',', '.'));
      return number >= value?.value?.min && number <= value?.value?.max;
    };
    return filterBy(array, value?.position, predicate);
  };
  return {
    filterByText,
    filterByOption,
    filterByDate,
    filterByBetween
  };
};
var _default = exports.default = useFilter;